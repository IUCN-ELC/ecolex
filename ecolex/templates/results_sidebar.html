{% load tags %}
<!-- <h4>Refine search</h4> -->

{% if not form.type.data or form.has_treaty %}
  <fieldset class="special-filter">
    <h5 data-toggle="collapse" {% if not form.has_treaty %}class="collapsed"{% endif %}
        data-target="#filter-treaties">Treaty filters</h5>

    <div id="filter-treaties" class="collapse {% if form.has_treaty %}in{% endif %}">
      {% if facets.trTypeOfText %}
        <h6>Type of document</h6>
        <ul class="filter-treaty" data-formid="#id_tr_type">
          {% include 'bits/checkbox_facet.html' with facet=facets.trTypeOfText form_field=form.tr_type %}
        </ul>
      {% endif %}

      <h6>Field of application</h6>
      <ul class="filter-treaty" data-formid="#id_tr_field">
        {% include 'bits/checkbox_facet.html' with facet=facets.trFieldOfApplication form_field=form.tr_field %}
      </ul>

      <h6>Participants</h6>
      <select id="tr_party" multiple="multiple" data-formid="#id_tr_party" hidden>
        {% include 'bits/select_facet.html' with facet=facets.partyCountry form_field=form.tr_party %}
      </select>

      <h6>Subject</h6>
      <select id="tr_subject" multiple="multiple" data-formid="#id_tr_subject" hidden>
        {% include 'bits/select_facet.html' with facet=facets.trSubject form_field=form.tr_subject %}
      </select>
    </div>
  </fieldset>
{% endif %}

{% if not form.type.data or form.has_decision %}
  <fieldset class="special-filter">
    <h5 data-toggle="collapse" {% if not form.has_decision %}class="collapsed"{% endif %}
        data-target="#filter-cop-decisions">COP Decision filters</h5>

    <div id="filter-cop-decisions" class="collapse {% if form.has_decision %}in{% endif %}">
      {% if facets.decType %}
        <h6>Type of document</h6>
        <ul class="filter-decision" data-formid="#id_dec_type">
          {% include 'bits/checkbox_facet.html' with facet=facets.decType form_field=form.dec_type %}
        </ul>
      {% endif %}

      <h6>Decision status</h6>
      <ul class="filter-decision" data-formid="#id_dec_status">
        {% include 'bits/checkbox_facet.html' with facet=facets.decStatus form_field=form.dec_status %}
      </ul>

      <h6>Treaty</h6>
      <select id="dec_treaty" multiple="multiple" data-formid="#id_dec_treaty" hidden>
        {% include 'bits/select_facet.html' with facet=facets.decTreatyId type_map=dec_treaty_names form_field=form.dec_treaty %}
      </select>
    </div>
  </fieldset>
{% endif %}

<fieldset class="global-filter">
  <h5 data-toggle="collapse"
      data-target="#filter-global">Global filters</h5>

  <div id="filter-global" class="collapse in">
    <h6>Keywords</h6>
    <input type="text" id="tagManager" class="tm-input" placeholder="Add Keywords" />
    <!--<select id="keyword" multiple="multiple" data-formid="#id_keyword" hidden>
      {% include 'bits/select_facet.html' with facet=facets.docKeyword form_field=form.keyword %}
    </select>-->

    {% if form.yearmin.data or form.yearmax.data or stats_fields.docDate %}
      <h6>Years</h6>
      <input id="slider-years" type="text"
             data-slider-min="1860"
             data-slider-max="2015"
             data-slider-value="[{{ form.yearmin.data|default:1860 }},{{ form.yearmax.data|default:2015 }}]"
             data-slider-tooltip="hide"/>
      <div class="slider-years">
        <div class="slider-min">
          <!-- <label for="year-min">From</label> -->
          <input id="year-min" type="number"
                 data-formid="#id_yearmin" 
                 value="{{ form.yearmin.data }}"
                 min="1860" 
                 placeholder="First ({{ stats_fields.docDate.min|just_year }})">
        </div>
        <div class="slider-max">
          <!-- <label for="year-max">To</label> -->
          <input id="year-max" type="number" 
                 data-formid="#id_yearmax"
                 value="{{ form.yearmax.data }}"
                 max="2015" 
                 placeholder="Last ({{ stats_fields.docDate.max|just_year }})">
        </div>
      </div>
    {% endif %}
  </div>
</fieldset>

<input class="btn btn-default btn-sm btn-block" type="reset" value="Reset all filters">
