{% extends 'layout.html' %}
{% load tags %}

{% block breadcrumbs %}
  {% breadcrumb "Search results" 'results' query %}
  {% breadcrumb "Treaty" 'treaty_details' query slug=treaty.solr.slug %}
  {% breadcrumb "COP decisions" %}
{% endblock %}

{% block content %}
<p>
  <span class="treaty-name">{{ treaty.full_title }}</span>
</p>

<hr>

<article class="record-details-decisions">
  <header>
    <h1>Treaty decisions</h1>
  </header>

  <table class="table decisions-expanded">
    <thead>
      <th>#</th>
      <th>Title</th>
    </thead>
    {% regroup treaty.decisions by meeting_title as decision_list %}
    {% for decision in decision_list %}
      <tbody>
        <tr>
          <th colspan="3">{{ decision.grouper }}</th>
        </tr>
        {% for item in decision.list %}
        <tr>
          <td>
            <span title="Decision number">{{ item.document_id }}</span>
          </td>
          <td>
            <div class="treaty-link-container">
              <h3 class="search-result-title">
                <a href="{{ item.details_url }}?{{ query }}"
                   title="{{ item.title|safe|striptags }}">{{ item.title|safe }}</a>
              </h3>
              {% include 'short_display/decision.html' with result=item%}
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    {% endfor %}
  </table>

</article>
{% endblock %}
