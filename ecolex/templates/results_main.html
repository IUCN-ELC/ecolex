{% load tags %}

{% include 'bits/type_facet.html' %}

{% if text_suggestion and results.get_suggested_text %}
<p id="suggestion">
  <em>Did you mean: <a href="?q={{ results.get_suggested_text }}" id="suggestion-link">{{ results.get_suggested_text }}</a>?</em>
</p>
{% endif %}

<p class="small clearfix">
  {# Ugly #}
    Found <span id="number-of-results">{{ results.count|default:"no" }}</span>
    {% if form.type.data|length != 1 %}
      result{{ results.count|pluralize }}.
    {% elif 'treaty' in form.type.data %}
      treat{{ results.count|pluralize:"y,ies" }}.
    {% elif 'decision' in form.type.data %}
      COP decision{{ results.count|pluralize }}.
    {% elif 'literature' in form.type.data %}
      literature item{{ results.count|pluralize }}.
    {% elif 'court_decision' in form.type.data %}
      court decision{{ results.count|pluralize }}.
    {% elif 'legislation' in form.type.data %}
      legislation record{{ results.count|pluralize }}.
    {% else %}
      {{ form.type.data|join:" or " }} thing, really.
    {% endif %}
{% if results %}
  Show only
  {% for id, txt in form.fields.type.choices %}{% if not forloop.first %} | {% endif %}
  <a href="{% url "results" %}?{{ form.type|field_urlencoded:id }}">
    {% if id == "treaty" %}Treaties
    {% elif id == "decision" %}COP Decisions
    {% elif id == "legislation" %}Legislation
    {% elif id == "court_decision" %}Court Decisions
    {% elif id == "literature" %}Literature
    {% endif %}
  </a>
  {% endfor %}
</p>
<p class="small clearfix">
    {% include 'bits/sortby.html' %}
</p>
{% endif %}
</p>

{% if results  %}
<hr>

<ul class="search-results">
  {% for result in results %}
    {% include "bits/search_result.html" with result=result results=results %}
  {% endfor %}
</ul>

<hr>

<div class="clearfix">

  {% if page.no_pages %}

    <div class="pull-right">

      <a class="btn btn-sm btn-default"
         href="?{{ page.prev_url }}"
         {% if page.number == 1 %}disabled{% endif %}>Previous</a>

        {% if 1 not in page.pages_list%}
            <a class="btn btn-sm btn-default"
               href="?{{ page.first_url }}">1</a>
             ...
        {% endif %}
        {% for page_no in page.pages_list %}
            {% if page_no != page.number %}
                <a class="btn btn-sm btn-default"
                   href="?{{ page.pages_urls|lookup:page_no }}">{{ page_no }}</a>
            {% else %}
                <a class="btn btn-sm btn-default"
                   href="?{{ page.pages_urls|lookup:page_no }}" disabled>
                    <b>{{ page_no }}</b>
                </a>
            {% endif %}
        {% endfor %}
        {% if page.no_pages not in page.pages_list%}
            {% if page.no_pages|add:"-1" not in page.pages_list %}
             ...
            {% endif %}
            <a class="btn btn-sm btn-default"
               href="?{{ page.last_url }}">{{ page.no_pages }}</a>
        {% endif %}

      <a class="btn btn-sm btn-default"
         href="?{{ page.next_url }}"
         {% if page.number == page.no_pages %}disabled{% endif %}>Next</a>

    </div>

  {% else %}

  <div class="form-control-static">No more results</div>

  {% endif %}


</div>
{% endif %}{# /if results  #}
