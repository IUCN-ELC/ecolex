{% load tags %}

{% include 'bits/type_facet.html' %}

{% if text_suggestion and results.get_suggested_text %}
<p id="suggestion">
  <em>Did you mean: <a href="?q={{ results.get_suggested_text }}" id="suggestion-link">{{ results.get_suggested_text }}</a>?</em>
</p>
{% endif %}

<p class="small clearfix">
  <!-- Ugly -->
  <span class="pull-left">
    Found
    {% if form.type.data|length != 1 %}
      <span id="number-of-results">{{ results.count }}</span> results
    {% elif 'treaty' in form.type.data %}
      <span id="number-of-results">{{ facets.type.treaty }}</span> treaties
    {% elif 'decision' in form.type.data %}
      <span id="number-of-results">{{ facets.type.decision }}</span> COP decisions
    {% elif 'literature' in form.type.data %}
      <span id="number-of-results">{{ facets.type.literature }}</span> literatures
    {% endif %}
  </span>

  <span class="pull-right">
    {% include 'bits/sortby.html' %}
  </span>
</p>

<hr>

<!-- To do -->
<!-- <button data-toggle="offcanvas" data-target="#filters" data-canvas="body"></button> -->

<ul class="search-results">
  {% for result in results %}
    {% include "bits/search_result.html" with result=result results=results %}
  {% endfor %}
</ul>

<hr>

<div class="clearfix">

  {% if page.no_pages %}

    <div class="pull-right">

      <a class="btn btn-sm btn-default"
         href="?{{ page.prev_url }}"
         {% if page.number == 1 %}disabled{% endif %}>Previous</a>

        {% if 1 not in page.pages_list%}
            <a class="btn btn-sm btn-default"
               href="?{{ page.first_url }}">1</a>
             ...
        {% endif %}
        {% for page_no in page.pages_list %}
            {% if page_no != page.number %}
                <a class="btn btn-sm btn-default"
                   href="?{{ page.pages_urls|lookup:page_no }}">{{ page_no }}</a>
            {% else %}
                <a class="btn btn-sm btn-default"
                   href="?{{ page.pages_urls|lookup:page_no }}" disabled>
                    <b>{{ page_no }}</b>
                </a>
            {% endif %}
        {% endfor %}
        {% if page.no_pages not in page.pages_list%}
            {% if page.no_pages|add:"-1" not in page.pages_list %}
             ...
            {% endif %}
            <a class="btn btn-sm btn-default"
               href="?{{ page.last_url }}">{{ page.no_pages }}</a>
        {% endif %}

      <a class="btn btn-sm btn-default"
         href="?{{ page.next_url }}"
         {% if page.number == page.no_pages %}disabled{% endif %}>Next</a>

    </div>

  {% else %}

  <div class="form-control-static">No more results</div>

  {% endif %}


</div>
