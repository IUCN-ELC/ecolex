{% extends 'layout.html' %}
{% load tags %}

{% block breadcrumbs %}
  {% breadcrumb "Search results" 'results' query %}
  {% breadcrumb "Literature" %}
{% endblock %}

{% block content %}
{% informea_url_id document %}

<article class="record-details">

  <header>
    <div class="record-title">
      <div class="record-icon">
        <span class="icon icon-literature" title="Literature"></span>
      </div>
      <h1>{{ document.title|safe }}</h1>
    </div>
  </header>

  <section id="details">
    <dl>
      {% if document.people_authors %}
        <dt>Author{{ document.people_authors|length|pluralize:",s" }}</dt>
        <dd>{{ document.people_authors | join_by:", " | safe }}</dd>
      {% elif document.corp_authors %}
        <dt>Corporate author{{ document.corp_authors|length|pluralize:",s" }}</dt>
        <dd>{{ document.corp_authors | join_by:", " | safe }}</dd>
      {% endif %}
      {% if document.parent_title %}
        <dt>In</dt>
        <dd>{{ document.parent_title | safe }}</dd>
      {% endif %}

      {% for entry in document.optional_fields %}
        <dt>{{ entry.label }}</dt>
        <dd>{{ entry.value }}</dd>
      {% endfor %}
      {% if document.type_of_document %}
        <dt>Document type</dt>
        <dd>{{ document.type_of_document|capfirst }}</dd>
      {% endif %}
      {% if document.solr.litRelatedWebSite %}
      <dt>Available web site</dt>
      <dd>
          <a class="decision-link" href="{{ document.solr.litRelatedWebSite | url_normalize }}">{{ document.solr.litRelatedWebSite }}</a>
      </dd>
      {% endif %}
      {% if document.solr.litLinkDOI %}
      <dt>Available DOI</dt>
      <dd>
          <a class="decision-link" href="{{ document.solr.litLinkDOI | url_normalize }}">{{ document.solr.litLinkDOI }}</a>
      </dd>
      {% endif %}
    </dl>
  </section>

  <section id="text">
    <dl>
      {% if document.region %}
        <dt>Geographical area</dt>
        <dd>{{ document.region }}</dd>
      {% endif %}
      {% if document.basin %}
        <dt>Basin</dt>
        <dd>{{ document.basin }}</dd>
      {% endif %}
      {% if document.jurisdiction %}
        <dt>Field of application</dt>
        <dd>{{ document.jurisdiction }}</dd>
      {% endif %}
      {% if document.countries %}
        <dt>Countr{{ document.countries|length|pluralize:"y,ies" }}</dt>
        <dd>{{ document.countries | join_by:", " | safe }}</dd>
      {% endif %}

      {% if document.subjects %}
        <dt>Subjects</dt>
        <dd>{{ document.subjects | join_by:", " | safe }}</dd>
      {% endif %}

      {% if document.keywords %}
      <dt>Keywords</dt>
      <dd>{% for keyword in document.keywords %}
            <span class="tag">{{ keyword|capfirst|safe }}</span>
          {% endfor %}
      </dd>
      {% endif %}

      {% if document.summary %}
        <dt>Abstract</dt>
        <dd><p class="abstract">{{ document.summary|safe }}</p></dd>
      {% endif %}

      <dt>Source</dt>
      <dd><a target="_blank" href="http://iucn.org">{{ document.source }}</a> (ID: {{ document.document_id }})</dd>

      {% if document.link_to_full_text %}
      <dt>Link to full text</dt>
      <dd>
          {% for link in document.link_to_full_text %}
            <a class="decision-link" href="{{ link.0 }}" target="_blank">{{ link.1 }}</a>
          {% endfor %}
      </dd>
      {% endif %}
    </dl>
  </section>

  <section id="other-references">
    {% if references_to.items %}
      <h2 class="section-title">References to</h2>
      {% for doc_type, docs in references_to.items %}
        <dl>
          <dt>{{ doc_type|capfirst }}</dt>
          {% for doc in docs %}
            <dd>

              <h3 class="search-result-title">
                <a href="{{ doc.details_url }}?{{ query }}"
                   title="{{ doc.title|safe|striptags }}">{{ doc.title|safe }}</a>
              </h3>

              {% if doc_type == 'court_decision' %}
                {% include 'short_display/court_decision.html' with result=doc %}
              {% elif doc_type == 'treaty' %}
                {% include 'short_display/treaty.html' with result=doc %}
              {% elif doc_type == 'literature' %}
                {% include 'short_display/literature.html' with result=doc %}
              {% elif doc_type == 'legislation' %}
                {% include 'short_display/legislation.html' with result=doc %}
              {% endif %}
            </dd>
          {% endfor %}
        </dl>
      {% endfor %}
    {% endif %}

    {% if references_from.items %}
      <h2 class="section-title">References from</h2>
      {% for doc_type, docs in references_from.items %}
        <dl>
          <dt>{{ doc_type|capfirst }}</dt>
          {% for doc in docs %}
            <dd>
              <h3 class="search-result-title">
                <a href="{{ doc.details_url }}?{{ query }}"
                   title="{{ doc.title|safe|striptags }}">{{ doc.title|safe }}</a>
              </h3>
              {% include 'short_display/literature.html' with result=doc %}
            </dd>
          {% endfor %}
        </dl>
      {% endfor %}
    {% endif %}
    <a class="decision-link" href="http://www.ecolex.org/ecolex/ledge/view/RecordDetails?index=literature&id={{ document.document_id }}" target="_blank">Link to ecolex.org (for testing purposes)</a>
  </section>

</article>
{% endblock content %}
